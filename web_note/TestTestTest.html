<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- Title -->
    <title>測試區</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../css/bootstrap_5.3.3_css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../css/bootstrap_icons-main/font/bootstrap-icons.css"/>
    <link rel="stylesheet" href="../css/font_awesome_v6.5.2_all.css" type="text/css" />
    <link rel="stylesheet" href="../css/animate_v4.1.1_min.css">
    <link rel="stylesheet" href="../css/main.css"/>

    <!-- jQuery -->
    <script src="../js/jquery_v3.7.1_min.js"></script>
    <!-- Bootstrap Bundle JS -->
    <script src="../js/bootstrap_5.3.3_js/bootstrap.bundle.min.js"></script>
    <script src="../js/d3_v7.9.0_min.js"></script>
    <script src="../js/wow_v1.1.3_min.js"></script>
    <script src="../js/script.js"></script>
    <script>
      // function heightCaculator(x) {
      //   var x = Math.round(x);
      //   var y = x * (16 / 9);
      //   y = parseFloat(y.toFixed(1));
      //   var z = x + (y - x) / 2;
      //   z = z.toFixed(1);
        
      //   if (x !== NaN) {
      //     alert("這張圖長邊 " + y + " px，短邊 " + x + " px\n\n有 " + (x*y/10000).toFixed(1) + " 萬像素\n加黑框後的短邊為 " + z + " px");
      //   } else {
      //     alert("非可計算數值");
      //   }
        
      // };

      // var h = prompt("請輸入短邊長（較小的數字）", "");
      // heightCaculator(h);
    </script>
    <style>
      body {
        padding: 30px;
      }
    </style>
  </head>
  <body>
    <h2>歡迎來到測試場</h2>
    <hr>
    <section>
      <div>
        <label>資料數量</label>
        <input type="number" class="dataLength">
        <button type="button" class="getRandomData">點擊產生隨機資料</button>
      </div>
      <div>data資料集：<span class="showData"></span></div>
      <div class="chartWrap"></div>
      <script>
        const getRandomData = document.querySelector('.getRandomData');
        const dataLength = document.querySelector('input');
        const showData = document.querySelector('.showData');
        let randomData = [];

        getRandomData.addEventListener("click", (e) => {
          randomData.length = 0;

          for (i = 0; i < dataLength.value; i++) {
            // 產生並塞入隨機亂數資料
            let random = Math.floor(Math.random() * 5);
            randomData.push(random);
          }

          // 畫面呈現目前資料集
          showData.innerHTML = randomData;
          
          // 繪製圖表
          drawDiagram();
        });

        // 建立SVG畫布
        const rangeSelect = d3.select('.chartWrap')
                              .append('svg')
                              .attr('width', 400)
                              .attr('height', 300)
                              .style('border', '1px solid rgb(96, 96, 96)');
        
        const drawDiagram = () => {
          // 綁定update資料
          let rects = rangeSelect.selectAll('rect')
                                 .data(randomData)
                                 .join(
                                   (enter) => enter.append('rect')
                                                   .attr('width', (d) => d * 60)
                                                   .attr('height', 40)
                                                   .style('fill', 'blue')
                                                   .attr('x', (d, index) => 0)
                                                   .attr('y', (d, index) => index * 60),
                                   (update) => update.attr('width', (d) => d * 60),
                                   (exit) => exit.remove()
                                 );
                                 
          // rects.enter()
          //      .append('rect')
          //      .attr('width', (d) => d * 60)
          //      .attr('height', 40)
          //      .style('fill', 'blue')
          //      .attr('x', (d, index) => 0)
          //      .attr('y', (d, index) => index * 60);

          // rects.attr('width', (d) => d * 60);
               
          // rects.exit().remove();
        };

      </script>
    </section>    

  </body>
</html>