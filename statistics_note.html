<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>統計學筆記</title>
  </head>

  <body style="padding: 20px;">
    <h1>112-2 統計學與實習下 期末考大抄 <small>2024.06.06</small></h1>
    <hr>
    <div id="oneWayAnova">
      <h2>One-way ANOVA</h2>
      <table frame="void" rules="groups" cellpadding="7">
        <thead align="center">
          <tr>
            <th>Source of Variation</th>
            <th>Sum of Square</th>
            <th>df</th>
            <th>Mean of Square</th>
            <th>F</th>
          </tr>
        </thead>
        <tbody align="center">
          <tr>
            <td>Treatments</td>
            <td>SST</td>
            <td>k-1</td>
            <td>MST = \(\frac{SST}{k-1}\)</td>
            <td>\(\frac{MST}{MSE}\)</td>
          </tr>
          <tr>
            <td>Error</td>
            <td>SSE</td>
            <td>n-k</td>
            <td>MSE = \(\frac{SSE}{n-k}\)</td>
            <td></td>
          </tr>
          <tr>
            <td>Total</td>
            <td>SS Total</td>
            <td>n-1</td>
            <td></td><td></td>
          </tr>
        </tbody>
      </table>
      <div style="padding: 20px;">
        <p>SS Total = \(\sum{(x-\overline{X_G})^2}\)</p>
        <p>SSE = \(\sum{(x-\overline{X_{Treatment}})^2}\)<br>&ensp;&ensp;&ensp;&ensp;= \(\sum{(x-\overline{X_1})^2}\) + \(\sum{(x-\overline{X_2})^2}\) + ... + \(\sum{(x-\overline{X_n})^2}\)</p>
        <p>SST = SS Total - SSE</p>
        <p>CI = \((\overline{X_1}-\overline{X_2}) \pm t\cdot\sqrt{MSE\cdot(\frac{1}{n_1}+\frac{1}{n_2})}\)</p>
      </div>
    </div>
    <div id="twoWayAnova">
      <h2>Two-way ANOVA</h2>
      <table frame="void" rules="groups" cellpadding="7">
        <thead align="center">
          <tr>
            <th>Source of Variation</th>
            <th>Sum of Square</th>
            <th>df</th>
            <th>Mean of Square</th>
            <th>F</th>
          </tr>
        </thead>
        <tbody align="center">
          <tr>
            <td>Treatments</td>
            <td>SST</td>
            <td>k-1</td>
            <td>MST = \(\frac{SST}{k-1}\)</td>
            <td>\(\frac{MST}{MSE}\)</td>
          </tr>
          <tr>
            <td>Blocks</td>
            <td>SSB</td>
            <td>b-1</td>
            <td>MSB = \(\frac{SSB}{b-1}\)</td>
            <td>\(\frac{MSB}{MSE}\)</td>
          </tr>
          <tr>
            <td>Error</td>
            <td>SSE</td>
            <td>(k-1)(b-1)</td>
            <td>MSE = \(\frac{SSE}{(k-1)(b-1)}\)</td>
            <td></td>
          </tr>
          <tr>
            <td>Total</td>
            <td>SS Total</td>
            <td>n-1</td>
            <td></td><td></td>
          </tr>
        </tbody>
      </table>
      <div style="padding: 20px;">
        <p>SSB = \(k\cdot\sum{(\overline{X_B}-\overline{X_G})^2}\)</p>
        <p>SST = \(b\cdot\sum{(\overline{X_T}-\overline{X_G})^2}\)</p>
        <p>SS Total = \(\sum{(x-\overline{X_G})^2}\)</p>
        <p>SSE = SS Total - SST - SSB</p>
        <p style="padding-top: 20px;">F = \(\frac{MST}{MSE}\) ~ F<sub>(k-1, (k-1)(b-1), α)</sub></p>
        <p>F = \(\frac{MSB}{MSE}\) ~ F<sub>(b-1, (k-1)(b-1), α)</sub></p>
      </div>
    </div>
    <div id="correlationCoefficient">
      <h2>相關係數 Correlation Coefficient</h2>
      <div style="padding: 20px;">
        <p>r = \(\frac{\sum{(X-\overline{X})(Y-\overline{Y})}}{(n-1)\cdot S_X\cdot S_Y}\) = \(\frac{S_{XY}}{S_X \cdot S_Y}\)</p>
        <p>S<sub>XY</sub> = \(\frac{\sum{(X-\overline{X})(Y-\overline{Y})}}{n-1}\), S<sub>X</sub> = \(\frac{\sum{(X-\overline{X})^2}}{n-1}\), S<sub>Y</sub> = \(\frac{\sum{(Y-\overline{Y})^2}}{n-1}\)</p>
        <table cellpadding="7">
          <tr>
            <th>Strong negative correlation</th>
            <th>Moderate negative correlation</th>
            <th>Weak negative correlation</th>
            <th>Weak positive correlation</th>
            <th>Moderate positive correlation</th>
            <th>Strong positive correlation</th>
          </tr>
          <tr>
            <td colspan="6" align="center">-------------------------------------------------------------------------------------------------&gt;</td>
          </tr>
        </table>
        <p>母體相關係數ㄉ假設檢定： <u>H<sub>0</sub>: ρ = 0, H<sub>1</sub>: ρ ≠ 0</u> ｜ <u>H<sub>0</sub>: ρ &le; 0, H<sub>1</sub>: ρ &gt; 0</u> ｜ <u>H<sub>0</sub>: ρ &ge; 0, H<sub>1</sub>: ρ &lt; 0</u></p>
        <p>t = \(\frac{r - 0}{\sqrt{\frac{1-r^2}{n-2}}}\) = \(\frac{r\cdot\sqrt{n-2}}{\sqrt{1-r^2}}\) ~ t<sub>(df = n-2)</sub></p>
      </div>
    </div>
    <div id="leastSquaresPrinciple">
      <h2>最小平方法 Least Squares Principle</h2>
      <h3>普通最小平方法 Ordinary Least Squares (OLS)</h3>
      <div style="padding: 20px;">
        <p>\(\hat{y}\) = a + b\(x\)</p>
        <p>b = \(r\cdot\frac{S_Y}{S_X}\) = \(\frac{S_{XY}}{(S_X)^2}\) = \(\frac{\sum{(X-\overline{X})(Y-\overline{Y})}}{\sum{(X-\overline{X})^2}}\) = \(\frac{\sum{XY}-\frac{\sum{X}\cdot\sum{Y}}{n}}{\sum{X^2}-\frac{(\sum{X})^2}{n}}\)</p>
        <p>a = \(\overline{y}\) - b\(\overline{x}\)</p>
        <p style="padding-top: 20px;">&beta;的假設檢定： <u>H<sub>0</sub>: &beta; = 0, H<sub>1</sub>: &beta; ≠ 0</u> ｜ <u>H<sub>0</sub>: &beta; &le; 0, H<sub>1</sub>: &beta; &gt; 0</u> ｜ <u>H<sub>0</sub>: &beta; &ge; 0, H<sub>1</sub>: &beta; &lt; 0</u></p>
        <p>t = \(\frac{b-0}{S_b}\) ~ t<sub>(df = n-2)</sub></p>
        <p>S<sub>b</sub> = \(\sqrt{\frac{MSE}{\sum{(X-\overline{X})^2}}}\), MSE = \(\frac{\sum{(Y_i-\hat{Y_i})^2}}{n-2}\)</p>
      </div>
    </div>
    <div id="theStandardErrorOfEstimate">
      <h2>估計標準誤（殘差） The Standard Error of Estimate</h2>
      <div style="padding: 20px;">
        <p>\(S_{y\cdot x}\) = \(\sqrt{\frac{\sum{(y-\hat{y})}}{n-2}}\) = \(\sqrt{\frac{SSE}{n-2}}\) = \(\sqrt{MSE}\)</p>
        <p>（ \(\underbrace{SSE}_{殘差平方和}\) = \(\sum{(y-\hat{y})^2}\), MSE = \(\frac{\sum{(y-\hat{y})^2}}{n-2}\) = \(\sqrt{MSE}\) ）</p>
        <p>\(\underbrace{總變異（y-\hat{y}）}_{SS Total}\) = \(\underbrace{迴歸可解釋變異（\hat{y}-\overline{y}）}_{SST}\) + \(\underbrace{不可解釋變異（隨機變異）}_{SSE}\)</p>
      </div>
    </div>
    <div id="theCoefficientOfDetermination">
      <h2>The Coefficient of Determination</h2>
      <p style="padding: 20px;">判定係數R<sup>2</sup> = r<sup>2</sup> = \(\frac{可解釋變異}{總變異}\) = \(\frac{SSR}{SS Total}\) = 1-\(\frac{SSE}{SS Total}\)</p>
      <table frame="void" rules="groups" cellpadding="7">
        <thead align="center">
          <tr>
            <th></th>
            <th>Sum of Square</th>
            <th>df</th>
            <th>Mean of Square</th>
            <th>F</th>
          </tr>
        </thead>
        <tbody align="center">
          <tr>
            <td>Regression</td>
            <td>SSR = \(\sum{(\hat{y}-\overline{y})^2}\)</td>
            <td>1</td>
            <td>\(\underbrace{MST = \frac{SSR}{1}}_{迴歸的平均變異}\)</td>
            <td>F = \(\frac{MSR}{MSE}\) ~ F<sub>(1, n-2, &alpha;)</sub></td>
          </tr>
          <tr>
            <td>Residual</td>
            <td>SSE = \(\sum{(y-\hat{y})^2}\)</td>
            <td>n-2</td>
            <td>\(\underbrace{MSE = \frac{SSE}{n-2}}_{殘差的平均變異}\)</td>
            <td></td>
          </tr>
          <tr>
            <td>Total</td>
            <td>\(\sum{(y-\overline{y})^2}\)</td>
            <td>n-1</td>
            <td></td>
            <td>H<sub>0</sub>: 迴歸方程式無解釋力</td>
          </tr>
        </tbody>
      </table>
      <div style="padding: 20px;">
        <p>R<sub>adj</sub><sup>2</sup> = 1 - \(\frac{\frac{SSE}{n-(K+1)}}{\frac{SS Total}{n-1}}\)</p>
      </div>
    </div>
    <div id="CI">
      <h2>Confidence Interval <small>預測母體迴歸線的平均數</small></h2>
      <p>\(\hat{y} \pm t \cdot S_{y \cdot x}\sqrt{\frac{1}{n}+\frac{(X-\overline{X})^2}{\sum{(X-\overline{X})^2}}}\) <small style="padding-left: 30px;">平均數的CI</small></p>
      <h2>Prediction Interval <small>預測單一反應值y</small></h2>
      <p>\(\hat{y} \pm t \cdot S_{y \cdot x}\sqrt{1+\frac{1}{n}+\frac{(X-\overline{X})^2}{\sum{(X-\overline{X})^2}}}\) <small style="padding-left: 30px;">單一反應值的CI</small></p>
      <p>（SSX = \(\sum{(X-\overline{X})^2}\)）</p>
    </div>
    <div id="multipleRegressionAnalysis">
      <h2>Multiple Regression Analysis</h2>
      <table frame="void" rules="groups" cellpadding="7">
        <thead>
          <tr>
            <th></th>
            <th>Coefficient</th>
            <th>SE coefficient</th>
            <th>……</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Intercept</td>
            <td><span style="background-color: yellow;">a</span> 427.194</td>
            <td>……</td>
            <td>……</td>
          </tr>
          <tr>
            <td>Temp <span style="background-color: cadetblue;">x<sub>1</sub></span></td>
            <td><span style="background-color: yellow;">b<sub>1</sub></span> -4.583</td>
            <td><span style="background-color: darksalmon;">S<sub>b1</sub></span>……</td>
            <td>……</td>
          </tr>
          <tr>
            <td>Insul <span style="background-color: cadetblue;">x<sub>2</sub></span></td>
            <td><span style="background-color: yellow;">b<sub>2</sub></span> -14.831</td>
            <td><span style="background-color: darksalmon;">S<sub>b2</sub></span>……</td>
            <td>……</td>
          </tr>
          <tr>
            <td>Age <span style="background-color: cadetblue;">x<sub>3</sub></span></td>
            <td><span style="background-color: yellow;">b<sub>3</sub></span> 6.101</td>
            <td><span style="background-color: darksalmon;">S<sub>b3</sub></span>……</td>
            <td>……</td>
          </tr>
        </tbody>
      </table>
      <p style="padding: 20px;">\(\hat{y}\) = a + \({b_1}{x_1}\) + \({b_2}{x_2}\) + \({b_3}{x_3}\) + ... + \({b_k}{x_k}\)</p>
      <table frame="void" rules="groups" cellpadding="7">
        <thead align="center">
          <tr>
            <th>Source</th>
            <th>df</th>
            <th>SS</th>
            <th>MS</th>
            <th>F</th>
          </tr>
        </thead>
        <tbody align="center">
          <tr>
            <td>Regression</td>
            <td>k</td>
            <td>SSR = \(\sum{(\hat{y}-\overline{y})^2}\)</td>
            <td>MSR = \(\frac{SSR}{k}\)</td>
            <td>F = \(\frac{MSR}{MSE}\) ~ F<sub>(k, n-k-1, &alpha;)</sub></td>
          </tr>
          <tr>
            <td>Residual or Error</td>
            <td>n-(k+1)</td>
            <td>SSE = \(\sum{(y-\hat{y})^2}\)</td>
            <td>MSE = \(\frac{SSE}{n-(k+1)}\)</td>
            <td></td>
          </tr>
          <tr>
            <td>Total</td>
            <td>n-1</td>
            <td>SS Total</td>
            <td></td>
            <td>H<sub>0</sub>: 迴歸方程式無解釋力<br>（&beta;<sub>1</sub>=&beta;<sub>2</sub>=&beta;<sub>3</sub>=...=&beta;<sub>k</sub>=0）</td>
          </tr>
        </tbody>
      </table>
      <div style="padding: 20px;">
        <p>\(S_{y \cdot {1.2.3....k}}\) = \(\sqrt{\frac{\sum{(y-\hat{y})^2}}{n-(k+1)}}\) = \(\sqrt{\frac{SSE}{n-(k+1)}}\)</p>
        <p>Global Test: F = \(\frac{MSR}{MSE}\) ~ F<sub>(k, n-k-1, &alpha;)</sub></p>
        <p>Individual: t = \(\frac{b_i-0}{S_{bi}}\) ~ t<sub>(n-(k+1), &alpha;)</sub></p>
      </div>
    </div>
    <div id="varianceInflationFactor">
      <h2>Variance Inflation Factor (VIF)</h2>
      <div style="padding: 20px;">
        <p>VIF = \(\frac{1}{1-R_j^2}\)</p>
      </div>
    </div>
    <div id="examRCode">
      <h2>期中上機考的Rcode筆記</h2>
      <div>
        <pre style="background-color: #1e1e1e; color: #d4d4d4; padding-left: 32px;">
  <code>
##### Note #####
### One Sample Z-test ###
sample <- c(2, 3, 5, 7, 11, 13, 17, 19)
library(BSDA)
z.test(sample, mu = 10, sigma.x = 2, alternative = "greater", conf.level = 0.99)

### One Sample T-test ###
sample <- c(2, 3, 5, 7, 11, 13, 17, 19)
sample_t_test <- t.test(sample, alternative = "two.sided", mu = 10, conf.level = 0.95)
#alternative = "two.sided" or "less" or "greater"
n = length(sample)
if(sample_t_test$p.value > qt(0.975, n-1)){
  print("reject the null hypothesis")
}else{
  print("can not reject the null hypothesis")
}

## 手算檢定統計量
n = length(sample)
sample_mean = mean(sample)
sample_sd = sd(sample)
sample_t = (sample_mean - 10) / (sample_sd / sqrt(n))
qt(0.025, n-1); qt(0.975, n-1)
if(abs(sample_t) > qt(0.975, n-1)){
  print("reject the null hypothesis")
}else{
  print("can not reject the null hypothesis")
}

## 手算信賴區間
n = length(sample)
sample_mean = mean(sample)
sample_sd = sd(sample)
UL = sample_mean + qt(0.975, n-1) * (sample_sd / sqrt(n))
LL = sample_mean - qt(0.975, n-1) * (sample_sd / sqrt(n))
print(c(LL, UL))

## 手算p-value
n = length(sample)
sample_mean = mean(sample)
sample_sd = sd(sample)
sample_t = (sample_mean - 10) / (sample_sd / sqrt(n))
pt(sample_t, n-1)
pt(sample_t, n-1) * 2


### Proportion Test ###
prop.test(x = 500, n = 1068, p = 0.5, alternative = "two.sided", conf.level = 0.95)
# H0: pi==0.5 ; H1: pi!==0.5


### Population Variance Test ###
train_A <- baseball[which(baseball$program == 'A'),]
train_B <- baseball[which(baseball$program == 'B'),]
var(train_A$rate); var(train_B$rate)
var.test(train_B$rate, train_A$rate)
#var.test(樣本變異大, 樣本變異小)
Ftest = var.test(train_B$rate, train_A$rate)
if(Ftest$p.value < 0.05){
  print("變異數不同")
}else{
  print("未有足夠證據拒絕兩者不同")
}
# H0: (sigma_1)^2==(sigma_2)^2 ; H1: (sigma_1)^2!==(sigma_2)^2
# F == (S_1)^2 / (S_2)^2 , df == (n_1 - 1, n_2 - 1)


### Two Sample Z-test ###
library(BSDA)
z.test(x = train_A$rate, y = train_B$rate, alternative = "two.sided", sigma.x = 0.02, sigma.y = 0.03, conf.level = 0.95)
qnorm(0.025)
# H0: mu_1 - mu_2 == 0 ; H1: mu_1 - mu_2 !== 0
# Z = (X_1 - X_2) / sqrt(( (sd_1)^2 / n_1 )+( (sd_2)^2 / n_2 ))


### Two Sample T-test ###
## Equal Population Variance ##
t.test(x = train_A$rate, y = train_B$rate, alternative = "two.sided", paired = FALSE, var.equal = TRUE, conf.level = 0.95)
qt(0.025, length(train_A$rate)+length(train_B$rate)-2)
# H0: mu_1 == mu_2 ; H1: mu_1 !== mu_2
# t(df) = (X_1 - X_2) / sqrt( ( s(p)^2 )*(( 1 / n_1 )+( 1 / n_2 )))
# df = n_1 + n_2 - 2
# s(p)^2 = ( ( n_1 - 1 )*( s_1 )^2 + ( n_2 - 1 )*( s_2 )^2 )/( n_1 + n_2 - 2 )


## Unequal Population Variance ##
# R code 待確認
# H0: mu_1 == mu_2 ; H1: mu_1 !== mu_2
# t(df) = (X_1 - X_2) / sqrt(( (s_1)^2 / n_1 )+( (s_2)^2 / n_2 ))
# df = 很複雜的那一坨


### Dependent Sample ###
t.test(x = train_A$rate, y = train_B$rate, paired = TRUE)
qt(0.025, length(train_A$rate)-1)
# H0: mu(d) == 0 ; H1: mu(d) !== 0
# d = X_1 - X_2
# t(n-1) = d/( s(d)/sqrt(n) )


### 兩組樣本的比例檢定 ###
table(sex = Abortion$SEX, abany = Abortion$ABANY)
prop.test(c(382,455), c(804,1006), correct = FALSE)


### 卡方適合度檢定 ###
table_RACE <- table(Abortion$RACE)
chisq.test(table_RACE, p=c(0.75, 0.15, 0.1), correct =  FALSE)
qchisq(0.95, df=2)
# H0: p_1==p_2==p_3==p_4==...===p_k ; H1: 不完全相同
# df = k-1
# 卡方檢定統計量 = sum( ((O_i - E_i)^2)/E_i )


### 卡方列聯表分析 ###
## By Function
chisq.test(table(Abortion$ABANY, Abortion$RACE), correct = FALSE)
#亦可作"chisq.test(table(Abortion$RACE, Abortion$ABANY), correct = FALSE)"，前後順序不影響結果

## By Definition
obs <- table(Abortion$ABANY, Abortion$RACE)
obs <- cbind(obs, rowSums(obs))
obs <- rbind(obs, colSums(obs))
exp <- chisq <- matrix(NA,nrow=2,ncol=3)
for(row in 1:2){
  for(col in 1:3){
    exp[row,col] <- obs[row,4]*obs[3,col]/1810
    chisq[row,col] <- ((exp[row,col] - obs[row,col])^2)/exp[row,col]
  }
}
sum(chisq)
qchisq(0.95, df=2)
# df = (r-1)(c-1)
# 卡方檢定統計量 = sum( ((O_i - E_i)^2)/E_i )
  </code>
        </pre>
      </div>
      <h2>期末上機考的Rcode筆記</h2>
      <div>
        <pre style="background-color: #1e1e1e; color: #d4d4d4; padding-left: 32px;">
  <code>
rm(list=ls())
data = read.csv(file="/Users/dongguanting/Downloads/exam.csv", header=T)
##### 期末考Note #####
### ANOVA(Analysis of variance)
summary(score)
female <- score[which(score$gender == 'Female'),]
male <- score[which(score$gender == 'Male'),]
aov.posttest <- aov(posttest ~ school_setting, data = score)
summary(aov.posttest)



## One-way ANOVA ##
rice_exp$var <- as.factor(rice_exp$var)

# method1 - aov()
aov.yield.1 <- aov(yield ~ var, data = rice_exp)
summary(aov.yield.1)

# method2 - anova()
lm.yield.1 <- lm(yield ~ var, data = rice_exp)
anova(lm.yield.1)


## Pairwise Comparison（計算pairs間的信賴區間） ##
library(agricolae)
LSD.test(aov.yield.1, "var", group = FALSE, console = TRUE)
#group = F -> 計算每個pair的信賴區間
#console = T -> 印出報表



## Two-way ANOVA ##

# method1 - aov()
aov.yield.2 <- aov(yield ~ field + var, data = rice_exp)
summary(aov.yield.2)

# method2 - anova()
lm.yield.2 <- lm(yield ~ field + var, data = rice_exp)
anova(lm.yield.2)


## Pairwise Comparison ##
library(agricolae)
# Comparison among treatments
LSD.test(aov.yield.2, 'var', group = F, console = T)

# Comparison among blocks
LSD.test(aov.yield.2, 'field', group = F, console = T)



### 統計繪圖 ###
## 圖型種類 ##
Pie() #圓餅圖
barplot() #長條圖
plot() #次數多邊圖
hist() #直方圖
plot() #散佈圖

## 基礎繪圖參數 ##
#main 主標題
#xlab x軸標題
#ylab y軸標題
#xlim x軸左右界限
#ylim y軸上下界限
#col 顏色
#lty 線的樣式
#pch 點的樣式
par(pty = 's')
plot(x, y, main = '')
abline(model1, col = 'blue', lwd = 5)

## 同時繪製多個變數間的散佈圖
pairs(iris[,5], col = iris$Species, pch = 16)
library(GGally)
ggpairs(iris[,1:4])



## 相關係數 ##
cor(iris$Sepal.Length, iris$Petal.Length)

## 相關性檢定 ##
cor.test(iris$Sepal.Length, iris$Petal.Length)



## 線性迴歸 ##
# method1 手動計算
sy <- sd(iris$Petal.Length); sx <- sd(iris$Sepal.Length)
meany = mean(iris$Petal.Length); meanx = mean(iris$Sepal.Length)
r <- cor(iris$Petal.Length, iris$Sepal.Length)
b <- r*(sy/sx)
a <- meany - b*meanx
r; a; b

# method2 用程式計算
model1 <- lm(Petal.Length ~ Sepal.Length, data = iris)
coef(model1)

## 線性迴歸ANOVA檢定 ##
summary(model1)
anova(model1)

## 預測 ##
# method1 手動計算
b*6.33 + a

# method2 用程式計算
new.data <- data.frame(Sepal.Length = c(6.33))
predict(model1, new.data)

## 區間預測 ##
new.data <- data.frame(Sepal.Length = c(5, 6, 7, 8, 9))
predict.lm(model, new.data, interval = 'confidence')
predict.lm(model, new.data, interval = 'prediction')

## 區間預測繪圖 ##
new <- data.frame(Sepal.Length = seq(min(iris$Sepal.Length),
                                     max(iris$Sepal.Length), 0.01))
cinterval <- predict.lm(model1, new, interval = 'confidence')
pinterval <- predict.lm(model1, new, interval = 'prediction')
par(pty = 's')
plot(iris$Sepal.Length, iris$Petal.Length, pch = 16,
     main = 'Relation between sepal length and petal length',
     xlab = 'Sepal Length (cm)', ylab = 'Petal Length (cm)')
abline(model1)
lines(new$Sepal.Length, cinterval[,3], lty = 'dashed', col = 'blue', lwd = 2)
lines(new$Sepal.Length, cinterval[,2], lty = 'dashed', col = 'blue', lwd = 2)
lines(new$Sepal.Length, pinterval[,3], lty = 'dashed', col = 'orange', lwd = 2)
lines(new$Sepal.Length, pinterval[,2], lty = 'dashed', col = 'orange', lwd = 2)


## 多元迴歸分析 ##
mlr <- lm(Petal.Width ~ Sepal.Width + Sepal.Width + Petal.Length, data = iris)
summary(mlr)

## 迴歸診斷 ##
# 殘差圖 #
par(pty = 's')
plot(fitted.values(mlr), residuals(mlr),
     main = 'Residuals plot',
     xlab = 'Fitted values',
     ylab = 'Residuals')
abline(0, 0, col = 2)

# 分佈圖(Quantile-Qiantile plot) #
par(mfrow = c(1, 2), pty = 's')
qqnorm(residuals(mlr))
qqline(residuals(mlr), col = 2)

# 變異數膨脹因子(VIF) #
library(car)
vif(mlr)
  </code>
        </pre>
      </div>
    </div>
    <div>
      <h2>參考資料</h2>
      <p><a href="https://hackmd.io/@CynthiaChuang/Basic-LaTeX-Commands" target="_blank">常用 LaTeX 數學符號指令</a></p>
      <p><a href="http://temporarynotesssss.blogspot.com/2014/09/html.html" target="_blank">［HTML］常用的特殊符號</a></p>
    </div>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </body>
</html>