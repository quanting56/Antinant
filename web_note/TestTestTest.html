<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- Title -->
    <title>測試區</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../css/bootstrap_5.3.3_css/bootstrap.min.css"/>
    <link rel="stylesheet" href="../css/bootstrap_icons-main/font/bootstrap-icons.css"/>
    <link rel="stylesheet" href="../css/font_awesome_v6.5.2_all.css" type="text/css" />
    <link rel="stylesheet" href="../css/animate_v4.1.1_min.css">
    <link rel="stylesheet" href="../css/main.css"/>

    <!-- jQuery -->
    <script src="../js/jquery_v3.7.1_min.js"></script>
    <!-- Bootstrap Bundle JS -->
    <script src="../js/bootstrap_5.3.3_js/bootstrap.bundle.min.js"></script>
    <script src="../js/d3_v7.9.0_min.js"></script>
    <script src="../js/wow_v1.1.3_min.js"></script>
    <script src="../js/script.js"></script>
    <script>
      // function heightCaculator(x) {
      //   var x = Math.round(x);
      //   var y = x * (16 / 9);
      //   y = parseFloat(y.toFixed(1));
      //   var z = x + (y - x) / 2;
      //   z = z.toFixed(1);
        
      //   if (x !== NaN) {
      //     alert("這張圖長邊 " + y + " px，短邊 " + x + " px\n\n有 " + (x*y/10000).toFixed(1) + " 萬像素\n加黑框後的短邊為 " + z + " px");
      //   } else {
      //     alert("非可計算數值");
      //   }
        
      // };

      // var h = prompt("請輸入短邊長（較小的數字）", "");
      // heightCaculator(h);
    </script>
    <style>
      body {
        padding: 30px;
      }

      svg {
        width: 800px;
        height: 180px;
      }
    </style>
  </head>
  <body>
    <h2>歡迎來到測試場</h2>
    <hr>
    <svg>
      <path d="M50 20 C80 90,40 200,250,100" stroke="black" fill="none" stroke-width="2"></path>
    </svg>
    <hr>
    <h4>Generators</h4>
    <hr>
    <h5>Lines</h5>
    <svg id="lineWrapper"></svg>
    <script>
      const drawLine = d3.line().x((d) => d.x)
                                .y((d) => d.y);

      const lineData = [
        { x: 50, y: 180 },
        { x: 50, y: 100 },
        { x: 200, y: 100 },
        { x: 200, y: 20 },
        { x: 400, y: 20 },
      ];

      console.log("lineline", drawLine(lineData));

      d3.select("#lineWrapper")
        .append("path")
        .attr("d", drawLine(lineData))
        .attr("stroke", "black")
        .attr("stroke-width", "2")
        .attr("fill", "none");
    </script>
    <svg><path d="M50,180L50,100L200,100L200,20L400,20" stroke="black" stroke-width="2" fill="none"></path></svg>
    <hr>
    <h5>Areas</h5>
    <svg id="areaWrapper"></svg>
    <script>
      // const areaData =[{ x: 50, y: 100 },{ x: 200, y: 100 }];
      const areaData =[
        { x: 30, y: 180 },
        { x: 50, y: 100 },
        { x: 200, y: 100 },
        { x: 200, y: 20 },
        { x: 400, y: 20 },
      ];
      const drawArea = d3.area()
                         .x((d) => d.x)
                         .y0(10)
                         .y1((d) => d.y);
                         

      console.log(drawArea(areaData));

      d3.select("#areaWrapper")
        .append("path")
        .attr("d", drawArea(areaData))
        .attr("stroke", "blue")
        .attr("stroke-width", "3")
        .attr("fill", "rgba(31, 211, 255, 0.2)");
    </script>
    <hr>
    <h5>Curves</h5>
    <svg id="curveWrapper"></svg>
    <script>
      const curveData = [
        { x: 50, y: 180 },
        { x: 50, y: 100 },
        { x: 200, y: 100 },
        { x: 200, y: 20 },
        { x: 400, y: 20 },
      ];

      const drawLineCurveBasis = d3.line()
                                   .curve(d3.curveBasis)
                                   .x((d) => d.x)
                                   .y((d) => d.y);
      
      d3.select("#curveWrapper")
        .append("path")
        .attr("d", drawLineCurveBasis(curveData))
        .attr("stroke", "black")
        .attr("stroke-width", "2")
        .attr("fill", "none");
    </script>
    <hr>
    <h5>Arcs</h5>
    <svg id="arcWrapper" style="height: 200px;"></svg>
    <script>
      const drawArc = d3.arc()
                        .innerRadius(80)
                        .outerRadius(90)
                        .startAngle(Math.PI * 1.2)
                        .endAngle(Math.PI * 2.8);
      
      d3.select("#arcWrapper")
        .append("g")
        .attr("transform", "translate(250, 100)")
        .append("path")
        .attr("d", drawArc)
        .attr("stroke", "blue")
        .attr("fill", "blue");
    </script>
    <hr>
    <h4>Components</h4>
    <hr>
    <h5>Axes</h5>
    <svg id="axeWrapper"></svg>
    <script>
      const data =[
        { x: 10, y: 100 },
        { x: 20, y: 100 },
        { x: 30, y: 100 },
        { x: 90, y: 20 },
        { x: 220, y: 10 },
      ];
      const xData = data.map((i) => i.x);
      const xScale = d3.scaleLinear()
                       .domain([0, d3.max(xData)])
                       .range([10, 290]);
      const xAxis= d3.axisBottom(xScale);
      
      d3.select("#axesWrapper")
        .append("g")
        .call(xAxis)
        .attr("transform", "translate(0, 130)");   
    </script>
    <hr>
    <h4>Layout</h4>
    <hr>
    <h5>Stacks</h5>
    <svg id="stackWrapper"></svg>
    <script>
      const dataStack = [
        { month: new Date(2023, 0, 1), China: 132, America: 120, Taiwan: 30 },
        { month: new Date(2023, 1, 1), China: 70, America: 127, Taiwan: 98 },
        { month: new Date(2023, 2, 1), China: 130, America: 33, Taiwan: 118 },
        { month: new Date(2023, 3, 1), China: 60, America: 90, Taiwan: 60 },
      ];
      const stackGenerator = d3.stack()
                               .keys(["China", "America", "Taiwan"]);
      const stackedSeries = stackGenerator(dataStack);
      
      const colorScale = d3.scaleOrdinal()
                           .domain(["China", "America", "Taiwan"])
                           .range(["red", "blue", "orange"]);
      const g = d3.select("#stackWrapper")
                  .attr("width", 300)
                  .selectAll("#stackWrapper g")
                  .data(stackedSeries)
                  .enter()
                  .append("g")
                  .attr("fill", (d) => colorScale(d.key));
      
      g.selectAll("rect")
       .data((d) => d)
       .join("rect")
       .attr("width", (d) => d[1] - d[0])
       .attr("x", (d) => d[0])
       .attr("y", (d, i) => i * 35)
       .attr("height", 20);
    </script>
  </body>
</html>